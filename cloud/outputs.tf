#########
# Output Configuration

output "ec2instance_ip" {
  value = aws_instance.ec2instance.public_ip
}

output "ec2instance_dns" {
  value = aws_instance.ec2instance.public_dns
}


output "script_url" {
  value = "https://${aws_s3_object.script.bucket}.s3.${data.aws_region.current.name}.amazonaws.com/${aws_s3_object.script.key}"
}

resource "local_file" "variables" {
  content = <<-EOF
    #!/bin/bash
    export HOST="${aws_instance.ec2instance.public_dns}"
    export HOST_IP="${aws_instance.ec2instance.public_ip}"
    export SCRIPT_URL="https://${aws_s3_object.script.bucket}.s3.${data.aws_region.current.name}.amazonaws.com/${aws_s3_object.script.key}"
  EOF
  filename = "${path.module}/outputs/variables.env"
}
